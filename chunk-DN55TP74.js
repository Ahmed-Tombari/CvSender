import{A as F,B as k,c as N}from"./chunk-CFBPUEV5.js";import{$b as E,Bb as l,Cb as m,Db as V,Ea as i,Kb as d,L as S,Sa as u,V as D,Z as L,_b as T,bb as x,ca as p,cb as w,gb as s,gc as I,hb as o,ib as r,jb as c,ra as y,rb as _}from"./chunk-YCGGWR4I.js";function U(a,n){a&1&&(c(0,"div",5),o(1,"div",6),c(2,"div",7)(3,"div",8),r())}function j(a,n){if(a&1&&(o(0,"h3",9),l(1),r(),o(2,"div",10)(3,"span",11),l(4),r(),o(5,"span",12),l(6),r()()),a&2){let t=_();i(),m(t.mainMetricValue),i(2),s("ngClass",t.getTextColorClass()),i(),V(" ",t.secondaryMetricValue," "),i(2),m(t.secondaryMetricLabel)}}var g=class a{title="";mainMetricValue="";secondaryMetricLabel="";secondaryMetricValue="";period="";color="blue";icon="shopping_cart";isLoading=!1;getGradientClass(){switch(this.color){case"blue":return"bg-gradient-primary shadow-glow-primary";case"green":return"bg-gradient-secondary shadow-glow-secondary";case"orange":return"bg-gradient-warning shadow-glow-warning";case"pink":return"bg-gradient-danger shadow-glow-danger";default:return"bg-slate-500"}}getTextColorClass(){switch(this.color){case"blue":return"text-primary-DEFAULT";case"green":return"text-secondary-DEFAULT";case"orange":return"text-warning-DEFAULT";case"pink":return"text-danger-DEFAULT";default:return"text-slate-500"}}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=u({type:a,selectors:[["app-stat-card"]],inputs:{title:"title",mainMetricValue:"mainMetricValue",secondaryMetricLabel:"secondaryMetricLabel",secondaryMetricValue:"secondaryMetricValue",period:"period",color:"color",icon:"icon",isLoading:"isLoading"},decls:9,vars:4,consts:[[1,"glass-card","p-6","flex","items-center","gap-5","group","cursor-pointer"],[1,"w-14","h-14","rounded-2xl","flex","items-center","justify-center","text-white","shadow-lg","transform","group-hover:scale-110","transition-transform","duration-300",3,"ngClass"],[1,"scale-125"],[1,"flex-1"],[1,"text-sm","font-medium","text-slate-500","dark:text-slate-400","mb-1"],[1,"h-8","w-24","bg-slate-200","rounded","animate-pulse","mb-2"],[1,"flex","items-center","gap-2","mt-1"],[1,"h-4","w-12","bg-slate-100","rounded","animate-pulse"],[1,"h-4","w-16","bg-slate-100","rounded","animate-pulse"],[1,"text-2xl","font-bold","text-slate-800","dark:text-white","font-display","animate-fade-in"],[1,"flex","items-center","gap-2","mt-1","animate-fade-in"],[1,"text-xs","font-bold","px-2","py-0.5","rounded-full","bg-slate-50","dark:bg-slate-800",3,"ngClass"],[1,"text-xs","text-slate-400","dark:text-slate-500"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"div",1)(2,"mat-icon",2),l(3),r()(),o(4,"div",3)(5,"p",4),l(6),r(),x(7,U,4,0)(8,j,7,4),r()()),t&2&&(i(),s("ngClass",e.getGradientClass()),i(2),m(e.icon),i(3),m(e.title),i(),w(e.isLoading?7:8))},dependencies:[E,T,k,F],styles:["[_nghost-%COMP%]{display:block;transition:transform .3s ease,box-shadow .3s ease}[_nghost-%COMP%]:hover{transform:translateY(-8px);box-shadow:10px #0003}mat-icon[_ngcontent-%COMP%]{font-size:2rem;height:2rem;width:2rem;line-height:2rem}.stat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}"]})};var h=class a{http=p(I);apiUrl="http://localhost:5678/webhook-test/befe49ad-61d8-4813-81a7-38a4ec01fea8";state=y(null);isLoading=y(!1);summary=d(()=>this.state()?.summary);dailyChart=d(()=>this.state()?.cvSentCharts?.daily);monthlyChart=d(()=>this.state()?.cvSentCharts?.monthly);yearlyChart=d(()=>this.state()?.cvSentCharts?.yearly);sizeEvolutionChart=d(()=>this.state()?.cvSentCharts?.daily);CACHE_KEY="dashboard_data_v1";load(){let n=sessionStorage.getItem(this.CACHE_KEY);if(n)try{let t=JSON.parse(n);t&&(console.log("[DashboardService] Loaded data from cache"),this.state.set(t))}catch(t){console.warn("[DashboardService] Failed to parse cached data",t)}this.isLoading()||(this.isLoading.set(!0),console.log("[DashboardService] Loading data from:",this.apiUrl),this.http.get(this.apiUrl).pipe(D(t=>{console.log("[DashboardService] Raw response:",t);let e=null;Array.isArray(t)&&t.length>0?t[0].output?e=t[0].output:e=t[0]:t&&typeof t=="object"&&(t.output?e=t.output:e=t),e&&e.summary?(console.log("[DashboardService] State updated:",e),this.state.set(e),sessionStorage.setItem(this.CACHE_KEY,JSON.stringify(e))):console.warn("[DashboardService] Unexpected response structure. parsed data:",e)}),S(()=>this.isLoading.set(!1))).subscribe({error:t=>console.error("[DashboardService] HTTP Error:",t)}))}static \u0275fac=function(t){return new(t||a)};static \u0275prov=L({token:a,factory:a.\u0275fac,providedIn:"root"})};var O=class a{dashboardService=p(h);i18n=N;summary=this.dashboardService.summary;isLoading=this.dashboardService.isLoading;constructor(){this.dashboardService.load()}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=u({type:a,selectors:[["app-summary"]],decls:5,vars:24,consts:[[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6","p-6"],["color","blue","icon","description",3,"title","mainMetricValue","secondaryMetricLabel","secondaryMetricValue","period","isLoading"],["color","green","icon","rocket_launch",3,"title","mainMetricValue","secondaryMetricLabel","secondaryMetricValue","period","isLoading"],["color","orange","icon","cloud_upload",3,"title","mainMetricValue","secondaryMetricLabel","secondaryMetricValue","period","isLoading"],["color","pink","icon","monitor_heartbeat",3,"title","mainMetricValue","secondaryMetricLabel","secondaryMetricValue","period","isLoading"]],template:function(t,e){if(t&1&&(o(0,"div",0),c(1,"app-stat-card",1)(2,"app-stat-card",2)(3,"app-stat-card",3)(4,"app-stat-card",4),r()),t&2){let b,f,C,v,M;i(),s("title",e.i18n().statTotalFiles)("mainMetricValue",(((b=e.summary())==null?null:b.totalFiles)||0).toString())("secondaryMetricLabel",e.i18n().statFilesToday)("secondaryMetricValue",(((f=e.summary())==null?null:f.filesToday)||0).toString())("period",e.i18n().statPeriodAllTime)("isLoading",e.isLoading()),i(),s("title",e.i18n().statSendedFiles)("mainMetricValue",(((C=e.summary())==null?null:C.totalCVSent)||0).toString())("secondaryMetricLabel",e.i18n().statToday)("secondaryMetricValue",(((v=e.summary())==null?null:v.cvSentToday)||0).toString())("period",e.i18n().statPeriodAllTime)("isLoading",e.isLoading()),i(),s("title",e.i18n().statDailyUploads)("mainMetricValue",(((M=e.summary())==null?null:M.cvSentToday)||0).toString())("secondaryMetricLabel","CVs")("secondaryMetricValue",e.i18n().statActive)("period",e.i18n().statPeriodToday)("isLoading",e.isLoading()),i(),s("title",e.i18n().statSystemStatus)("mainMetricValue",e.i18n().statOnline)("secondaryMetricLabel",e.i18n().statUptime)("secondaryMetricValue","99.9%")("period",e.i18n().statPeriodNow)("isLoading",e.isLoading())}},dependencies:[g],encapsulation:2})};export{h as a,O as b};
